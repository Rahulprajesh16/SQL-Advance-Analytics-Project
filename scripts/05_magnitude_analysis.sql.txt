
                  ---Magnitude Exploration---
/*
 Compare the measure values by categories
 It helps us understand the importance of different categories

 SQL Functions used
    - Aggregate Functions: SUM(), COUNT(), AVG()
    - GROUP BY, ORDER BY

*/

--Find total customers by countries

select 
country,
count(customer_key) as Total_customers
from gold.dim_customers
group by country
order by Total_customers desc

--Find the total customers by gender

select
gender,
count(customer_key) as No_of_customers
from gold.dim_customers
group by gender
order by No_of_customers desc

--Find the total products by category

select
category,
count(product_key) as Total_products
from gold.dim_products
group by category
order by  Total_products desc

--What is the average costs in each category  

select
category,
avg(cost)  as Average_costs
from gold.dim_products
group by category
order by Average_costs desc

--What is the total revenue generated for each category

select 
p.category,
sum(f.sales_amount) as Total_revenue
from gold.fact_sales f
left join gold.dim_products p
on f.product_key=p.product_key
group by p.category
order by Total_revenue desc

--What is the total revenue generated by each customer

select
c.customer_key,
c.first_name,
c.last_name,
sum(f.sales_amount) as Total_revenue
from gold.fact_sales as  f
left join gold.dim_customers as c
on f.customer_key=c.customer_key
group by c.customer_key,c.first_name,c.last_name
order by Total_revenue desc

--What is the ditribution Quantity of items sold across countries

select 
c.country,
sum(f.quantity) as Total_sold_items
from 
gold.fact_sales as f
left join gold.dim_customers as c
on f.customer_key=c.customer_key
group by c.country
order by Total_sold_items desc

